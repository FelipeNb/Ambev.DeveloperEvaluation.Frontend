<p-card>
  <div class="p-d-flex p-jc-between p-ai-center">
    <h4>Carts</h4>
    <div>
      <button pButton label="Novo" (click)="openCreate()"></button>
    </div>
  </div>

  <p-table [value]="items$ | async" [loading]="loading$ | async">
    <ng-template pTemplate="header">
      <tr><th>UserId</th><th>Items</th><th>Actions</th></tr>
    </ng-template>
    <ng-template pTemplate="body" let-row>
      <tr>
        <td>{{row.userId}}</td>
        <td>
          <ul><li *ngFor="let it of row.items">{{it.productId}} x {{it.quantity}}</li></ul>
        </td>
        <td>
          <button pButton icon="pi pi-pencil" (click)="openEdit(row)"></button>
          <button pButton icon="pi pi-trash" (click)="remove(row.id)"></button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</p-card>

<p-dialog header="Cart" [(visible)]="displayDialog" [modal]="true" styleClass="p-fluid">
  <div class="p-field">
    <label>Usu√°rio</label>
    <p-dropdown [options]="users$ | async" optionLabel="name" optionValue="id" [(ngModel)]="cart.userId" placeholder="Select user"></p-dropdown>
  </div>

  <div class="p-field">
    <label>Produto</label>
    <p-dropdown [options]="products$ | async" optionLabel="name" [(ngModel)]="selectedProduct" placeholder="Select product"></p-dropdown>
  </div>

  <div class="p-field">
    <button pButton label="Adicionar item" (click)="addItem()" [disabled]="!cart.userId || !selectedProduct"></button>
  </div>

  <div class="p-field">
    <label>Items</label>
    <ul><li *ngFor="let it of cart.items">{{it.productId}} x {{it.quantity}}</li></ul>
  </div>

  <p-footer>
    <button pButton label="Salvar" (click)="save()" [disabled]="!cart.userId"></button>
  </p-footer>
</p-dialog>
